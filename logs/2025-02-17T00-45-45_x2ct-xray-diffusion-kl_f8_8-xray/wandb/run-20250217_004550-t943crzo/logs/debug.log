2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_setup.py:_flush():68] Current SDK version is 0.19.6
2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_setup.py:_flush():68] Configure stats pid to 3898373
2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_setup.py:_flush():68] Loading settings from /home/maximilian.schulze/.config/wandb/settings
2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_setup.py:_flush():68] Loading settings from /raid/maximilian.schulze/generative-models/wandb/settings
2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_setup.py:_flush():68] Loading settings from environment variables
2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_init.py:setup_run_log_directory():637] Logging user logs to /raid/maximilian.schulze/generative-models/logs/2025-02-17T00-45-45_x2ct-xray-diffusion-kl_f8_8-xray/wandb/run-20250217_004550-t943crzo/logs/debug.log
2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_init.py:setup_run_log_directory():638] Logging internal logs to /raid/maximilian.schulze/generative-models/logs/2025-02-17T00-45-45_x2ct-xray-diffusion-kl_f8_8-xray/wandb/run-20250217_004550-t943crzo/logs/debug-internal.log
2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_init.py:init():756] calling init triggers
2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_init.py:init():761] wandb.init called with sweep_config: {}
config: {'model': {'base_learning_rate': 1e-05, 'target': 'sgm.models.diffusion.DiffusionEngine', 'params': {'scale_factor': 0.13025, 'disable_first_stage_autocast': True, 'input_key': 'xray', 'scheduler_config': {'target': 'sgm.lr_scheduler.LambdaLinearScheduler', 'params': {'warm_up_steps': [10000], 'cycle_lengths': [10000000000000], 'f_start': [1e-05], 'f_max': [1.0], 'f_min': [1.0]}}, 'denoiser_config': {'target': 'sgm.modules.diffusionmodules.denoiser.DiscreteDenoiser', 'params': {'num_idx': 1000, 'scaling_config': {'target': 'sgm.modules.diffusionmodules.denoiser_scaling.EpsScaling'}, 'discretization_config': {'target': 'sgm.modules.diffusionmodules.discretizer.LegacyDDPMDiscretization'}}}, 'network_config': {'target': 'sgm.modules.diffusionmodules.openaimodel.UNetModel', 'params': {'use_checkpoint': True, 'in_channels': 8, 'out_channels': 8, 'model_channels': 320, 'attention_resolutions': [4, 2, 1], 'num_res_blocks': 2, 'channel_mult': [1, 2, 4, 4], 'num_head_channels': 64, 'use_linear_in_transformer': True, 'transformer_depth': 1, 'spatial_transformer_attn_type': 'softmax-xformers'}}, 'first_stage_config': {'target': 'sgm.models.autoencoder.AutoencodingEngine', 'params': {'input_key': 'xray', 'monitor': 'val/loss/rec', 'ckpt_engine': '/raid/maximilian.schulze/generative-models/logs/2025-02-13T19-45-44_x2ct-xray-imagenet-kl_f8_8chn-xray/checkpoints/epoch=000968.ckpt', 'encoder_config': {'target': 'sgm.modules.diffusionmodules.model.Encoder', 'params': {'attn_type': 'vanilla-xformers', 'double_z': True, 'z_channels': 8, 'resolution': 256, 'in_channels': 1, 'out_ch': 1, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0}}, 'decoder_config': {'target': 'sgm.modules.diffusionmodules.model.Decoder', 'params': {'attn_type': 'vanilla-xformers', 'double_z': True, 'z_channels': 8, 'resolution': 256, 'in_channels': 1, 'out_ch': 1, 'ch': 128, 'ch_mult': [1, 2, 4, 4], 'num_res_blocks': 2, 'attn_resolutions': [], 'dropout': 0.0}}, 'regularizer_config': {'target': 'sgm.modules.autoencoding.regularizers.DiagonalGaussianRegularizer'}, 'loss_config': {'target': 'torch.nn.Identity'}}}, 'loss_fn_config': {'target': 'sgm.modules.diffusionmodules.loss.StandardDiffusionLoss', 'params': {'loss_weighting_config': {'target': 'sgm.modules.diffusionmodules.loss_weighting.EpsWeighting'}, 'sigma_sampler_config': {'target': 'sgm.modules.diffusionmodules.sigma_sampling.DiscreteSampling', 'params': {'num_idx': 1000, 'discretization_config': {'target': 'sgm.modules.diffusionmodules.discretizer.LegacyDDPMDiscretization'}}}}}, 'sampler_config': {'target': 'sgm.modules.diffusionmodules.sampling.EulerEDMSampler', 'params': {'num_steps': 50, 'discretization_config': {'target': 'sgm.modules.diffusionmodules.discretizer.LegacyDDPMDiscretization'}, 'guider_config': {'target': 'sgm.modules.diffusionmodules.guiders.VanillaCFG', 'params': {'scale': 7.5}}}}}}, 'data': {'target': 'sgm.data.radchest.RadchestIndividualXrayDataloader', 'params': {'num_projections': 2, 'train': {'loader': {'batch_size': 64, 'num_workers': 8}, 'dataset': {'target': 'sgm.data.radchest.CachedXCT_H5_dataset', 'params': {'cache_dir': '/raid/maximilian.schulze/dataset_cache', 'optimize_zip': False, 'h5_dataset_path': '/raid/shared/x2ct/radchest/h5/sitk-dataset.h5', 'h5_ct_group_path': '512/ct', 'h5_xray_group_path': '512/drr', 'h5_text_dataset_path': '/raid/shared/x2ct/radchest/discription-latents-h5/short-template.h5', 'h5_text_group_path': 'BiomedCLIPTextEmbedder/V2/OneNonNegativeTokens', 'split_file': '/raid/shared/x2ct/radchest/train_val_split.json', 'train': True, 'scale': 256, 'scale_images': True, 'crop_size': 256, 'use_f16': False, 'ct_only': False, 'xray_only': True, 'load_text': True, 'num_projections': 2, 'is_preprocessed': False}}}, 'validation': {'loader': {'batch_size': 64, 'num_workers': 8}, 'dataset': {'target': 'sgm.data.radchest.CachedXCT_H5_dataset', 'params': {'cache_dir': '/raid/maximilian.schulze/dataset_cache', 'optimize_zip': False, 'h5_dataset_path': '/raid/shared/x2ct/radchest/h5/sitk-dataset.h5', 'h5_ct_group_path': '512/ct', 'h5_xray_group_path': '512/drr', 'h5_text_dataset_path': '/raid/shared/x2ct/radchest/discription-latents-h5/short-template.h5', 'h5_text_group_path': 'BiomedCLIPTextEmbedder/V2/OneNonNegativeTokens', 'split_file': '/raid/shared/x2ct/radchest/train_val_split.json', 'train': False, 'scale': 256, 'scale_images': True, 'crop_size': 256, 'use_f16': False, 'ct_only': False, 'xray_only': True, 'load_text': True, 'num_projections': 2, 'is_preprocessed': False}}}}}, '_wandb': {}}
2025-02-17 00:45:50,654 INFO    MainThread:3898373 [wandb_init.py:init():789] starting backend
2025-02-17 00:45:50,859 INFO    MainThread:3898373 [wandb_init.py:init():793] sending inform_init request
2025-02-17 00:45:50,861 INFO    MainThread:3898373 [backend.py:_multiprocessing_setup():97] multiprocessing start_methods=fork,spawn,forkserver, using: spawn
2025-02-17 00:45:50,862 INFO    MainThread:3898373 [wandb_init.py:init():808] backend started and connected
2025-02-17 00:45:50,864 INFO    MainThread:3898373 [wandb_init.py:init():901] updated telemetry
2025-02-17 00:45:50,866 INFO    MainThread:3898373 [wandb_init.py:init():936] communicating run to backend with 90.0 second timeout
2025-02-17 00:45:56,124 INFO    MainThread:3898373 [wandb_init.py:init():994] starting run threads in backend
2025-02-17 00:45:56,214 INFO    MainThread:3898373 [wandb_run.py:_console_start():2385] atexit reg
2025-02-17 00:45:56,214 INFO    MainThread:3898373 [wandb_run.py:_redirect():2235] redirect: wrap_raw
2025-02-17 00:45:56,214 INFO    MainThread:3898373 [wandb_run.py:_redirect():2300] Wrapping output streams.
2025-02-17 00:45:56,214 INFO    MainThread:3898373 [wandb_run.py:_redirect():2325] Redirects installed.
2025-02-17 00:45:56,215 INFO    MainThread:3898373 [wandb_init.py:init():1036] run started, returning control to user process
2025-02-17 20:40:50,440 INFO    MainThread:3898373 [wandb_run.py:_finish():2110] finishing run multimodal-x2ct/xray-stablediffusion/t943crzo
2025-02-17 20:40:50,441 INFO    MainThread:3898373 [wandb_run.py:_atexit_cleanup():2350] got exitcode: 0
2025-02-17 20:40:50,441 INFO    MainThread:3898373 [wandb_run.py:_restore():2332] restore
2025-02-17 20:40:50,441 INFO    MainThread:3898373 [wandb_run.py:_restore():2338] restore done
2025-02-17 20:40:52,689 INFO    MainThread:3898373 [wandb_run.py:_footer_history_summary_info():3963] rendering history
2025-02-17 20:40:52,690 INFO    MainThread:3898373 [wandb_run.py:_footer_history_summary_info():3995] rendering summary
2025-02-17 20:40:52,690 INFO    MainThread:3898373 [wandb_run.py:_footer_sync_info():3924] logging synced files
